<section class="posts-page">
    <div class="posts-container">
        <header class="posts-header">
            <h2 class="posts-title">Publicaciones</h2>

            <form [formGroup]="newPostForm" (ngSubmit)="createPost()" class="new-post-form">
                <input formControlName="titulo" placeholder="Título" />
                <textarea formControlName="mensaje" placeholder="¿Qué estás pensando?"></textarea>
                <input type="file" (change)="onFileChange($event)" accept="image/*" />
                
                @if (postImagePreview) {
                    <img [src]="postImagePreview" style="max-width: 100px; margin-top: 10px;">
                }
                <button type="submit" [disabled]="newPostForm.invalid">Publicar</button>
            </form>

            <div class="posts-filter">
                <label>Ordenar:
                    <select (change)="changeOrder($any($event.target).value)">
                        <option value="fecha">Fecha</option>
                        <option value="likes">Me gusta</option>
                    </select>
                </label>
            </div>
        </header>

        <div class="posts-list">
            @for (item of posts; track item._id) {
                <app-post [post]="item"></app-post>
            }
        </div>

        <div class="posts-more">
            @if (!isLoading && posts.length >= limit) {
                <button (click)="loadMore()">Cargar más</button>
            }
            @if (isLoading) { <p>Cargando...</p> }
        </div>
    </div>
</section>