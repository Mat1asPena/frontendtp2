<section class="register-page">
    <div class="register-overlay"></div>

    <div class="register-container">
        <div class="register-card">
        <h2 class="register-title">Registro</h2>

        <form class="register-form" (submit)="$any($event).preventDefault(); submit()" [formGroup]="form" novalidate>

            <div class="form-group">
                <label class="form-label">Nombre</label>
                <input class="form-input" formControlName="nombre">
                @if (form.get('nombre')?.touched && form.get('nombre')?.invalid) {
                    <small class="form-error">Requerido</small>
                }
            </div>

            <div class="form-group">
                <label class="form-label">Apellido</label>
                <input class="form-input" formControlName="apellido">
                @if (form.get('apellido')?.touched && form.get('apellido')?.invalid) {
                    <small class="form-error">Requerido</small>
                }
            </div>

            <div class="form-group">
                <label class="form-label">Correo</label>
                <input class="form-input" formControlName="correo" type="email">
                @if (form.get('correo')?.touched && form.get('correo')?.hasError('email')) {
                    <small class="form-error">Email inválido</small>
                }
            </div>

            <div class="form-group">
                <label class="form-label">Nombre de usuario</label>
                <input class="form-input" formControlName="nombreUsuario">
                @if (form.get('nombreUsuario')?.touched && form.get('nombreUsuario')?.invalid) {
                    <small class="form-error">Requerido (min 4)</small>
                }
            </div>

            <div class="form-group">
                <label class="form-label">Contraseña</label>
                <input class="form-input" formControlName="password" type="password">
                @if (form.get('password')?.touched && form.get('password')?.hasError('minlength')) {
                    <small class="form-error">Mín 8</small>
                }
                @if (form.get('password')?.touched && form.get('password')?.hasError('pattern')) {
                    <small class="form-error">Debe tener 1 mayúscula y 1 número</small>
                }
            </div>

            <div class="form-group">
                <label class="form-label">Repetir contraseña</label>
                <input class="form-input" formControlName="confirmPassword" type="password">
                @if (form.get('confirmPassword')?.touched && form.get('confirmPassword')?.hasError('mismatch')) {
                    <small class="form-error">No coincide</small>
                }
            </div>

            <div class="form-group">
                <label class="form-label">Fecha de nacimiento</label>
                <input class="form-input" formControlName="fechaNacimiento" type="date">
            </div>

            <div class="form-group">
                <label class="form-label">Descripción</label>
                <textarea class="form-textarea" formControlName="descripcion"></textarea>
            </div>

            <div class="form-group">
                <label class="form-label">Imagen de perfil</label>
                <input class="form-input-file" type="file" (change)="onFileChange($event)" accept="image/*">
            </div>

            @if (imagenPreview) {
            <div class="preview-container">
                <p class="preview-text">Preview:</p>
                <img class="preview-image" [src]="imagenPreview" alt="preview">
            </div>
            }

            <div class="form-actions">
                <button class="btn-register" type="submit" [disabled]="loading">Registrarme</button>
            </div>

            @if (errorMsg) {
            <p class="error-message">{{errorMsg}}</p>
            }

        </form>

        <p class="register-footer">
            ¿Ya tenés cuenta?
            <a href="/login">Iniciá sesión</a>
        </p>
        </div>
    </div>
</section>
